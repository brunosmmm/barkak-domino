import { useSoundSettings } from '../hooks/useSound';

interface SoundToggleProps {
  compact?: boolean;
}

export function SoundToggle({ compact = false }: SoundToggleProps) {
  const { enabled, volume, toggle, setVolume } = useSoundSettings();

  if (compact) {
    return (
      <button
        onClick={toggle}
        className={`p-2 rounded-lg transition-colors ${
          enabled
            ? 'text-neon-amber hover:bg-neon-amber/20'
            : 'text-gray-500 hover:bg-gray-700'
        }`}
        title={enabled ? 'Mute sounds' : 'Unmute sounds'}
        data-testid="sound-toggle"
      >
        {enabled ? (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
          </svg>
        ) : (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
          </svg>
        )}
      </button>
    );
  }

  return (
    <div className="flex items-center gap-3 p-3 bg-black/30 rounded-lg">
      <button
        onClick={toggle}
        className={`p-2 rounded-lg transition-colors ${
          enabled
            ? 'text-neon-amber bg-neon-amber/20'
            : 'text-gray-500 bg-gray-700'
        }`}
        title={enabled ? 'Mute sounds' : 'Unmute sounds'}
        data-testid="sound-toggle"
      >
        {enabled ? (
          <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
          </svg>
        ) : (
          <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
          </svg>
        )}
      </button>

      {enabled && (
        <input
          type="range"
          min="0"
          max="100"
          value={volume * 100}
          onChange={(e) => setVolume(Number(e.target.value) / 100)}
          className="w-24 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer
                     [&::-webkit-slider-thumb]:appearance-none
                     [&::-webkit-slider-thumb]:w-4
                     [&::-webkit-slider-thumb]:h-4
                     [&::-webkit-slider-thumb]:rounded-full
                     [&::-webkit-slider-thumb]:bg-neon-amber
                     [&::-webkit-slider-thumb]:shadow-neon-amber"
          title={`Volume: ${Math.round(volume * 100)}%`}
          data-testid="volume-slider"
        />
      )}
    </div>
  );
}
